# 健康食谱管理与膳食规划系统
## 测试文档

## 1. 文档概述

### 1.1 文档目的
本文档旨在为健康食谱管理与膳食规划系统提供全面的测试指南，包括测试策略、测试用例、测试方法和测试标准，确保系统功能正确、性能稳定、安全可靠，满足用户需求和设计要求。

### 1.2 适用范围
本文档适用于以下人员：
- 测试工程师
- 开发工程师
- 项目管理人员
- 质量保证人员
- 系统验收人员

### 1.3 术语定义
| 术语 | 解释说明 |
|------|----------|
| 单元测试 | 对软件中的最小可测试单元进行检查和验证 |
| 集成测试 | 测试模块间的接口以及集成后的功能正确性 |
| 系统测试 | 对完整的软件系统进行测试，验证其是否符合需求规格 |
| 验收测试 | 用户或客户对系统进行最终验收的测试 |
| 回归测试 | 对已修改的代码进行测试，确保修改不会影响原有功能 |
| 性能测试 | 评估系统在特定工作负载下的响应时间、吞吐量等指标 |
| 安全测试 | 验证系统的安全性，识别潜在的安全漏洞 |
| 测试用例 | 为特定目标而设计的一组测试输入、执行条件和预期结果 |
| Bug | 软件中的缺陷或错误，导致系统功能异常或不符合预期 |
| 测试覆盖率 | 衡量测试对代码或功能的覆盖程度的指标 |

## 2. 测试策略

### 2.1 测试目标
1. 确保系统的所有功能符合需求规格说明书的要求
2. 验证系统的性能满足设计标准和用户期望
3. 确认系统的安全性、可靠性和稳定性
4. 检测并修复系统中的缺陷和问题
5. 提供高质量的测试报告和测试结果

### 2.2 测试方法

#### 2.2.1 功能测试
- **黑盒测试**：不关注内部实现，基于功能需求进行测试
- **白盒测试**：关注代码实现，测试内部逻辑和算法
- **灰盒测试**：结合黑盒和白盒测试方法，测试系统接口和功能

#### 2.2.2 性能测试
- **负载测试**：测试系统在正常工作负载下的性能表现
- **压力测试**：测试系统在极限负载下的性能表现和稳定性
- **耐久性测试**：测试系统在长时间运行下的稳定性
- **并发测试**：测试系统在多用户并发访问下的性能表现

#### 2.2.3 安全测试
- **渗透测试**：尝试通过各种方式突破系统安全防线
- **漏洞扫描**：使用自动化工具扫描系统中的安全漏洞
- **身份验证测试**：测试用户身份验证和授权机制
- **数据加密测试**：测试敏感数据的加密和保护机制

#### 2.2.4 兼容性测试
- **浏览器兼容性测试**：测试系统在不同浏览器下的表现
- **操作系统兼容性测试**：测试系统在不同操作系统下的表现
- **移动端兼容性测试**：测试系统在移动设备上的表现

### 2.3 测试环境

#### 2.3.1 硬件环境
| 环境 | CPU | 内存 | 磁盘 | 网络 |
|------|-----|------|------|------|
| 开发环境 | 4核 | 8GB | 100GB SSD | 100Mbps |
| 测试环境 | 8核 | 16GB | 200GB SSD | 1Gbps |
| 生产环境 | 16核+ | 32GB+ | 500GB SSD | 1Gbps+ |

#### 2.3.2 软件环境
| 软件 | 版本 | 用途 | 测试环境配置 |
|------|------|------|-------------|
| JDK | 1.8+ | Java运行环境 | OpenJDK 1.8.0_292 |
| Node.js | 14.x+ | 前端开发环境 | Node.js 14.17.0 |
| MySQL | 8.0+ | 关系型数据库 | MySQL 8.0.25 |
| 阿里云OSS SDK | 3.x+ | 对象存储服务 | - |
| Nginx | 1.18+ | Web服务器 | Nginx 1.18.0 |
| Chrome | 90+ | 浏览器测试 | Chrome 96.0.4664.93 |
| Firefox | 88+ | 浏览器测试 | Firefox 95.0 |
| Safari | 14+ | 浏览器测试 | Safari 14.1.2 |
| Edge | 90+ | 浏览器测试 | Edge 96.0.1054.62 |

#### 2.3.3 测试工具
| 工具名称 | 用途 | 版本 |
|---------|------|------|
| JUnit | Java单元测试框架 | 5.7.2 |
| Mockito | 模拟测试框架 | 3.12.4 |
| Spring Boot Test | Spring Boot应用测试 | - |

## 3. 单元测试

### 3.1 单元测试策略
- 使用JUnit 5作为主要的单元测试框架
- 使用Mockito进行依赖模拟
- 测试每个类的公共方法和关键功能
- 确保测试覆盖率达到80%以上
- 每个测试用例应该是独立的，不依赖于其他测试用例

### 3.2 单元测试用例示例

#### 3.2.1 用户服务单元测试
**测试类**：UserServiceTest

**测试方法**：createUser()
- **测试目的**：验证用户创建功能的正确性
- **测试步骤**：
  1. 准备测试数据
  2. 调用createUser方法
  3. 验证返回结果和数据库状态
- **预期结果**：
  - 返回成功创建的用户对象
  - 数据库中包含新创建的用户记录
  - 用户密码已加密存储

**测试方法**：login()
- **测试目的**：验证用户登录功能的正确性
- **测试步骤**：
  1. 准备测试数据（已创建的用户）
  2. 使用正确的用户名和密码调用login方法
  3. 使用错误的用户名或密码调用login方法
- **预期结果**：
  - 正确的用户名和密码应返回登录成功，用户信息存储在Session中
  - 错误的用户名或密码应返回登录失败

#### 3.2.2 食谱服务单元测试
**测试类**：RecipeServiceTest

**测试方法**：getRecipeList()
- **测试目的**：验证获取食谱列表功能的正确性
- **测试步骤**：
  1. 准备测试数据（多个食谱记录）
  2. 使用不同的参数调用getRecipeList方法
  3. 验证返回的食谱列表是否符合预期
- **预期结果**：
  - 返回符合条件的食谱列表
  - 分页功能正常工作
  - 排序功能正常工作

**测试方法**：calculateNutrition()
- **测试目的**：验证营养计算功能的正确性
- **测试步骤**：
  1. 准备食材和用量数据
  2. 调用calculateNutrition方法
  3. 验证营养计算结果
- **预期结果**：
  - 返回正确的卡路里、蛋白质、碳水、脂肪等营养成分
  - 计算结果应四舍五入到合适的精度

### 3.3 单元测试规范
1. 测试类命名规范：被测类名+Test
2. 测试方法命名规范：test+被测试方法名+测试场景
3. 使用@BeforeEach初始化测试环境
4. 使用@AfterEach清理测试环境
5. 每个测试用例只测试一个功能点
6. 断言应明确、具体，验证预期结果
7. 测试代码应简洁、清晰、可维护

## 4. 集成测试

### 4.1 集成测试策略
- 测试模块间的接口和交互
- 测试组件集成后的功能正确性
- 测试数据库操作和事务处理
- 测试外部服务调用和API集成
- 重点关注数据流转和状态一致性

### 4.2 集成测试用例示例

#### 4.2.1 用户认证与授权集成测试
**测试场景**：用户登录与权限验证流程
- **测试目的**：验证用户认证与授权的完整流程
- **测试步骤**：
  1. 用户注册
  2. 用户登录（基于Session认证）
  3. 使用Session访问需要授权的API
  4. 测试不同权限级别的API访问
- **预期结果**：
  - 注册流程正常，用户数据正确存储
  - 登录成功后用户信息存储在Session中
  - 有权限的用户可以成功访问对应API
  - 无权限的用户访问被拒绝

#### 4.2.2 膳食计划与食谱集成测试
**测试场景**：创建膳食计划并添加食谱
- **测试目的**：验证膳食计划与食谱模块的集成功能
- **测试步骤**：
  1. 创建一个新的膳食计划
  2. 向膳食计划中添加多个食谱
  3. 查看膳食计划的营养分析
  4. 修改膳食计划中的食谱
- **预期结果**：
  - 膳食计划创建成功
  - 食谱成功添加到膳食计划中
  - 营养分析数据正确计算和显示
  - 修改操作正常执行，数据保持一致性

### 4.3 集成测试环境设置
1. 准备测试数据库，与生产环境结构相同
2. 配置测试环境变量和配置文件
3. 使用测试数据初始化系统
4. 确保外部依赖服务可用或使用模拟服务
5. 配置日志级别以方便调试

## 5. 系统测试

### 5.1 功能测试

#### 5.1.1 用户管理功能测试用例

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试状态 |
|------------|----------|----------|----------|----------|
| TC-USER-001 | 用户注册 | 1. 访问注册页面<br>2. 填写注册信息<br>3. 点击注册按钮 | 注册成功，跳转至登录页面 | 待测试 |
| TC-USER-002 | 用户登录 | 1. 访问登录页面<br>2. 输入正确的用户名和密码<br>3. 点击登录按钮 | 登录成功，跳转至系统首页 | 待测试 |
| TC-USER-003 | 修改密码 | 1. 登录系统<br>2. 进入账号安全设置<br>3. 输入旧密码和新密码<br>4. 点击保存 | 密码修改成功，使用新密码可登录 | 待测试 |
| TC-USER-004 | 个人信息修改 | 1. 登录系统<br>2. 进入个人中心<br>3. 修改个人信息<br>4. 保存修改 | 信息修改成功，页面显示更新后信息 | 待测试 |
| TC-USER-005 | 健康档案管理 | 1. 登录系统<br>2. 进入健康档案页面<br>3. 填写健康数据<br>4. 保存数据 | 健康档案保存成功，BMI值正确计算 | 待测试 |

#### 5.1.2 食谱管理功能测试用例

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试状态 |
|------------|----------|----------|----------|----------|
| TC-RECIPE-001 | 食谱浏览 | 1. 登录系统<br>2. 浏览食谱首页<br>3. 点击食谱分类<br>4. 查看分类食谱 | 食谱列表正确显示，分类筛选有效 | 待测试 |
| TC-RECIPE-002 | 食谱搜索 | 1. 在搜索框输入关键词<br>2. 点击搜索按钮<br>3. 应用高级筛选 | 搜索结果符合关键词和筛选条件 | 待测试 |
| TC-RECIPE-003 | 食谱详情查看 | 1. 点击食谱卡片<br>2. 查看食谱详情<br>3. 查看营养信息<br>4. 查看评论 | 食谱详情完整显示，营养信息准确 | 待测试 |
| TC-RECIPE-004 | 食谱收藏与分享 | 1. 在食谱详情页点击收藏<br>2. 点击分享按钮<br>3. 查看收藏列表 | 食谱成功收藏，分享功能正常 | 待测试 |
| TC-RECIPE-005 | 食谱评论与评分 | 1. 在食谱详情页输入评论<br>2. 选择评分<br>3. 提交评论 | 评论成功发布，评分更新 | 待测试 |

#### 5.1.3 膳食计划功能测试用例

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试状态 |
|------------|----------|----------|----------|----------|
| TC-PLAN-001 | 创建膳食计划 | 1. 进入膳食计划页面<br>2. 点击「创建新计划」<br>3. 填写计划信息<br>4. 保存计划 | 膳食计划创建成功，显示在计划列表 | 待测试 |
| TC-PLAN-002 | 添加食谱到计划 | 1. 进入计划详情页<br>2. 选择日期和餐食类型<br>3. 点击「添加餐食」<br>4. 选择食谱 | 食谱成功添加到计划中，显示在对应位置 | 待测试 |
| TC-PLAN-003 | 自定义餐食 | 1. 进入计划详情页<br>2. 点击「添加餐食」<br>3. 选择「自定义餐食」<br>4. 输入餐食信息 | 自定义餐食保存成功，显示在计划中 | 待测试 |
| TC-PLAN-004 | 查看营养分析 | 1. 进入计划详情页<br>2. 点击「营养分析」标签<br>3. 查看营养数据和图表 | 营养分析数据准确，图表显示正常 | 待测试 |
| TC-PLAN-005 | 标记餐食完成 | 1. 进入当日计划<br>2. 点击「标记完成」按钮<br>3. 添加执行备注 | 餐食状态更新为已完成，记录保存 | 待测试 |

### 5.2 性能测试

#### 5.2.1 性能测试场景

| 测试场景ID | 测试目的 | 用户并发数 | 持续时间 | 预期结果 |
|------------|----------|------------|----------|----------|
| PT-001 | 系统首页响应时间 | 100 | 30分钟 | 页面加载时间<3秒 |
| PT-002 | 食谱搜索性能 | 200 | 1小时 | 搜索响应时间<2秒 |
| PT-003 | 膳食计划创建性能 | 50 | 30分钟 | 创建响应时间<1秒 |
| PT-004 | 系统峰值负载测试 | 500 | 30分钟 | 系统稳定运行，无错误 |
| PT-005 | 数据库性能测试 | 100 | 1小时 | 查询响应时间<0.5秒 |

#### 5.2.2 性能测试指标
- **响应时间**：页面加载时间、API响应时间
- **吞吐量**：每秒处理的请求数
- **并发用户数**：系统可同时支持的用户数
- **资源利用率**：CPU、内存、磁盘I/O、网络I/O
- **错误率**：系统错误和异常的比例

#### 5.2.3 性能测试工具配置
- 使用JMeter创建测试脚本
- 配置线程组模拟并发用户
- 添加HTTP请求采样器
- 设置断言验证响应
- 配置监听器收集测试结果

### 5.3 安全测试

#### 5.3.1 安全测试场景

| 测试场景ID | 测试目的 | 测试方法 | 预期结果 |
|------------|----------|----------|----------|
| SC-001 | 身份验证测试 | 1. 尝试使用弱密码登录<br>2. 测试登录失败次数限制<br>3. 测试会话过期机制 | 系统拒绝弱密码，实施登录限制，会话正常过期 |
| SC-002 | 授权测试 | 1. 测试越权访问<br>2. 测试API权限控制<br>3. 测试管理员权限 | 系统正确实施权限控制，防止越权访问 |
| SC-003 | 输入验证测试 | 1. 测试SQL注入<br>2. 测试XSS攻击<br>3. 测试CSRF攻击 | 系统能防止常见的注入和跨站攻击 |
| SC-004 | 数据保护测试 | 1. 测试敏感数据加密<br>2. 测试日志中的敏感信息处理<br>3. 测试数据备份和恢复 | 敏感数据正确加密，日志不暴露敏感信息，备份恢复正常 |

#### 5.3.2 OWASP Top 10测试
针对OWASP Top 10中的常见安全风险进行测试：
1. 注入攻击测试
2. 失效的身份认证与会话管理测试
3. 跨站脚本(XSS)测试
4. 不安全的反序列化测试
5. 使用含有已知漏洞的组件测试
6. 安全配置错误测试
7. 敏感数据泄露测试
8. 不足的访问控制测试
9. 跨站请求伪造(CSRF)测试
10. 未验证的重定向和转发测试

### 5.4 兼容性测试

#### 5.4.1 浏览器兼容性测试

| 测试用例ID | 浏览器 | 版本 | 操作系统 | 测试内容 | 预期结果 |
|------------|--------|------|----------|----------|----------|
| CT-BROWSER-001 | Chrome | 最新版 | Windows 10 | 所有功能 | 功能正常，界面显示正确 |
| CT-BROWSER-002 | Firefox | 最新版 | Windows 10 | 所有功能 | 功能正常，界面显示正确 |
| CT-BROWSER-003 | Safari | 最新版 | macOS | 所有功能 | 功能正常，界面显示正确 |
| CT-BROWSER-004 | Edge | 最新版 | Windows 10 | 所有功能 | 功能正常，界面显示正确 |
| CT-BROWSER-005 | Chrome | 最新版 | Android | 主要功能 | 功能正常，移动适配良好 |
| CT-BROWSER-006 | Safari | 最新版 | iOS | 主要功能 | 功能正常，移动适配良好 |

#### 5.4.2 分辨率兼容性测试
- 1024x768
- 1366x768
- 1440x900
- 1920x1080
- 2560x1440

## 6. 验收测试

### 6.1 验收测试目标
- 验证系统是否满足用户需求规格说明书的所有要求
- 确认系统的功能、性能、安全等方面是否达到预期标准
- 为用户提供系统验收的依据和支持
- 确保系统可以正常交付和使用

### 6.2 验收测试标准
1. 所有功能测试用例通过率达到100%
2. 系统性能满足设计要求
3. 安全测试未发现严重安全漏洞
4. 用户界面符合设计规范，用户体验良好
5. 系统文档完整、准确、易于理解
6. 系统能够在目标环境中正常安装和运行

### 6.3 验收测试流程
1. 准备验收测试环境和测试数据
2. 制定验收测试计划和测试用例
3. 执行验收测试，记录测试结果
4. 分析测试结果，解决发现的问题
5. 提交验收测试报告
6. 进行用户培训和系统交接

## 7. 测试报告

### 7.1 测试报告结构
1. 测试概述
2. 测试环境
3. 测试执行情况
4. 测试结果统计
5. 问题分析
6. 测试结论
7. 建议和改进
8. 附录

### 7.2 测试结果统计示例

| 测试类型 | 测试用例数 | 通过数 | 失败数 | 通过率 |
|----------|------------|--------|--------|--------|
| 单元测试 | 500 | 480 | 20 | 96% |
| 集成测试 | 200 | 195 | 5 | 97.5% |
| 功能测试 | 300 | 290 | 10 | 96.7% |
| 性能测试 | 20 | 20 | 0 | 100% |
| 安全测试 | 50 | 45 | 5 | 90% |
| 兼容性测试 | 30 | 30 | 0 | 100% |
| **总计** | **1100** | **1060** | **40** | **96.4%** |

### 7.3 Bug严重程度分类

| 严重程度 | 定义 | 示例 |
|----------|------|------|
| 阻断性 | 系统核心功能无法使用，阻碍测试进行 | 系统无法启动，登录功能失效 |
| 严重 | 主要功能失效，影响系统正常使用 | 数据保存失败，重要功能异常 |
| 中等 | 次要功能异常，但不影响主要功能使用 | UI显示错误，非核心功能异常 |
| 轻微 | 影响用户体验，但不影响功能使用 | 拼写错误，界面布局微调 |
| 建议 | 非缺陷，对系统的改进建议 | 性能优化建议，UI改进建议 |

## 8. 测试管理与流程

### 8.1 测试生命周期
1. **测试计划阶段**：制定测试策略、计划和资源分配
2. **测试设计阶段**：编写测试用例、测试脚本和测试数据
3. **测试执行阶段**：执行测试用例，记录测试结果
4. **缺陷管理阶段**：报告、跟踪和验证缺陷
5. **测试总结阶段**：生成测试报告，总结测试经验

### 8.2 缺陷管理流程
1. **缺陷发现**：测试人员发现并记录缺陷
2. **缺陷报告**：填写缺陷报告，包括详细信息
3. **缺陷审核**：审核缺陷的有效性和严重程度
4. **缺陷分配**：将缺陷分配给相关开发人员
5. **缺陷修复**：开发人员修复缺陷
6. **缺陷验证**：测试人员验证缺陷是否已修复
7. **缺陷关闭**：确认缺陷已修复，关闭缺陷
8. **缺陷分析**：分析缺陷原因和模式，防止类似问题再次发生

### 8.3 测试文档管理
1. 所有测试文档应使用版本控制系统进行管理
2. 文档命名应规范，便于识别和查找
3. 文档应定期更新，保持与系统同步
4. 文档应包含版本信息、编写人、审核人等元数据
5. 重要测试文档应进行备份和归档

## 9. 测试工具与环境

### 9.1 测试工具列表

| 工具名称 | 用途 | 版本 | 配置要求 |
|---------|------|------|----------|
| JUnit 5 | Java单元测试 | 5.7.2 | JDK 8+ |
| Mockito | 模拟测试 | 3.12.4 | - |
| Spring Boot Test | Spring Boot应用测试 | - | JDK 8+ |

### 9.2 测试环境配置

**后端测试环境配置**：
```yaml
server:
  port: 8080

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/health_system_test?useSSL=false&serverTimezone=UTC
    username: test_user
    password: test_password
  # 自定义缓存配置
  cache:
    type: local
    maxSize: 1000
    expireTime: 300
  
  # 阿里云OSS配置
  aliyun:
    oss:
      endpoint: https://oss-cn-hangzhou.aliyuncs.com
      bucketName: test-health-system
      accessKeyId: ${OSS_ACCESS_KEY_ID}
      accessKeySecret: ${OSS_ACCESS_KEY_SECRET}

# 测试专用配置
test:
  mode: true
  mockExternalServices: true
```

**前端测试环境配置**：
```dotenv
# 测试环境配置
VITE_API_BASE_URL=http://test-api.healthsystem.com/api
VITE_APP_ENV=test
VITE_ENABLE_MOCK=true
```

## 10. 附录

### 10.1 测试数据准备指南
1. 准备基础测试数据，包括用户、食谱、膳食计划等
2. 使用自动化脚本生成测试数据
3. 确保测试数据覆盖各种场景和边界条件
4. 定期清理和更新测试数据

### 10.2 测试注意事项
1. 测试前确保测试环境准备就绪
2. 执行测试前备份重要数据
3. 记录测试过程中的所有操作和结果
4. 及时报告发现的问题和异常
5. 保持测试用例和测试脚本的更新
6. 遵循安全和保密原则

### 10.3 测试覆盖率标准
1. 代码覆盖率：至少80%
2. 功能覆盖率：100%
3. 路径覆盖率：关键路径100%
4. 边界值覆盖率：95%以上
5. 错误处理覆盖率：90%以上

import{_ as E,r as I,b as S,o as u,c,d as m,e as t,w as a,n as b,h as k,i as N,q as w,E as d,k as P,v as B,x as C,y as O,z as R}from"./index-c7857d1d.js";/* empty css              *//* empty css                 *//* empty css             */import{r as _}from"./request-2e544c9a.js";const F={style:{width:"50%"}},J={class:"card",style:{padding:"30px"}},L={style:{margin:"20px 0","text-align":"center"}},q=["src"],M={key:0},z={style:{"text-align":"center"}},A={__name:"Person",emits:["updateUser"],setup(D,{emit:i}){const f="http://:9090/files/upload",e=I({user:JSON.parse(localStorage.getItem("system-user")||"{}")}),g=s=>{console.log("个人头像上传响应:",s),e.user.avatar=s.data,console.log("使用完整OSS URL作为个人头像:",e.user.avatar);const o=new Image;o.onload=()=>console.log("个人头像URL有效，能够正常加载"),o.onerror=()=>console.error("个人头像URL无效，无法加载图片"),o.src=e.user.avatar},p=i,v=()=>{e.user.role==="ADMIN"?_.put("/admin/update",e.user).then(s=>{s.code==="200"?(d.success("更新成功"),localStorage.setItem("system-user",JSON.stringify(e.user)),p("updateUser")):d.error(s.msg)}):_.put("/user/update",e.user).then(s=>{s.code==="200"?(d.success("更新成功"),localStorage.setItem("system-user",JSON.stringify(e.user)),p("updateUser")):d.error(s.msg)})};return(s,o)=>{const y=S("Plus"),V=P,x=B,r=C,n=O,U=R,h=b;return u(),c("div",F,[m("div",J,[t(h,{model:e.user,"label-width":"100px",style:{"padding-right":"50px"}},{default:a(()=>[m("div",L,[t(x,{"show-file-list":!1,class:"avatar-uploader",action:f,"on-success":g},{default:a(()=>[e.user.avatar?(u(),c("img",{key:0,src:e.user.avatar,class:"avatar"},null,8,q)):(u(),k(V,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[t(y)]),_:1}))]),_:1})]),t(n,{label:"账号"},{default:a(()=>[t(r,{disabled:"",modelValue:e.user.username,"onUpdate:modelValue":o[0]||(o[0]=l=>e.user.username=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(n,{label:"名称"},{default:a(()=>[t(r,{modelValue:e.user.name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.user.name=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e.user.role==="USER"?(u(),c("div",M,[t(n,{label:"电话",prop:"phone"},{default:a(()=>[t(r,{modelValue:e.user.phone,"onUpdate:modelValue":o[2]||(o[2]=l=>e.user.phone=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(n,{label:"邮箱",prop:"email"},{default:a(()=>[t(r,{modelValue:e.user.email,"onUpdate:modelValue":o[3]||(o[3]=l=>e.user.email=l),autocomplete:"off"},null,8,["modelValue"])]),_:1})])):N("",!0),m("div",z,[t(U,{type:"primary",onClick:v},{default:a(()=>[w("保存")]),_:1})])]),_:1},8,["model"])])])}}},Q=E(A,[["__scopeId","data-v-8440cee1"]]);export{Q as default};

import{ad as le,o as B,c as X,d as p,a0 as L,i as J,ae as z,t as W,R as g,r as R,A as ae,af as re,p as G,j as H,_ as ie,e as h,w as _,ag as ue,h as ce,n as de,ab as fe,u as F,ah as me,ai as ve,q as K,E as N,a as pe,x as ge,y as he,N as ye,O as be,z as _e}from"./index-0b508a82.js";/* empty css             *//* empty css              *//* empty css               *//* empty css               */import{r as we}from"./request-617fd929.js";const V=Math.PI;function P(e,t){return e+t}function ke(e){return e*e}function x(e,t,s,n,o,c){e.beginPath(),e.moveTo(t,s),e.arc(t+n/2,s-o+2,o,.72*V,2.26*V),e.lineTo(t+n,s),e.arc(t+n+o-2,s+n/2,o,1.21*V,2.78*V),e.lineTo(t+n,s+n),e.lineTo(t,s+n),e.arc(t+o-2,s+n/2,o+.4,2.76*V,1.24*V,!0),e.lineTo(t,s),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[c](),e.globalCompositeOperation="destination-over"}function Ee(e,t){const s=document.createElement("img");return s.crossOrigin="Anonymous",s.onload=t,s.onerror=()=>{s.src=q(e)},s.src=q(e),s}function j(e,t){return Math.round(Math.random()*(t-e)+e)}function q(e){const t=e.length;return t>0?e[j(0,t-1)]:"https://source.unsplash.com/300x150/?book,library"}function Se(e,t,s={leading:!0,trailing:!0}){const{leading:n,trailing:o,resultCallback:c}=s;let r=0,v=null;const w=function(...u){return new Promise((d,a)=>{const l=new Date().getTime();!r&&!n&&(r=l);const i=t-(l-r);if(i<=0){v&&(clearTimeout(v),v=null);const f=e.apply(this,u);c&&c(f),d(f),r=l;return}o&&!v&&(v=setTimeout(()=>{v=null,r=n?new Date().getTime():0;const f=e.apply(this,u);c&&c(f),d(f)},i))})};return w.cancel=function(){v&&clearTimeout(v),v=null,r=0},w}function Te(){const e=R({x:0,y:0}),t=g(!1),s=g(!1),n=g(0),o=g([]);return{origin:e,success:t,isMouseDown:s,timestamp:n,trail:o,start:u=>{t.value||(u instanceof MouseEvent?(e.x=u.clientX,e.y=u.clientY):(e.x=u.changedTouches[0].pageX,e.y=u.changedTouches[0].pageY),s.value=!0,n.value=Date.now())},move:(u,d,a)=>{if(!s.value)return!1;let l=0,i=0;if(d instanceof MouseEvent?(l=d.clientX-e.x,i=d.clientY-e.y):(l=d.changedTouches[0].pageX-e.x,i=d.changedTouches[0].pageY-e.y),l<0||l+38>=u)return!1;a(l),o.value.push(i)},end:(u,d)=>{if(!s.value||(s.value=!1,(u instanceof MouseEvent?u.clientX:u.changedTouches[0].pageX)===e.x))return!1;n.value=Date.now()-n.value,d(n.value)},verify:(u,d,a)=>{const l=o.value,i=l.reduce(P)/l.length,f=l.map(S=>S-i),k=Math.sqrt(f.map(ke).reduce(P)/l.length),E=parseInt(u);return a=a<=1?1:a>10?10:a,{spliced:Math.abs(E-d)<=a,TuringTest:i!==k}}}}var Ce=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s};const Ie=le({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]},interval:{type:Number,default:50}},emits:["success","again","fail","refresh"],setup(e,{emit:t}){const{imgs:s,l:n,r:o,w:c,h:r,accuracy:v,interval:w}=e,u=g(!0),d=g(0),a=g(0),l=R({containerActive:!1,containerSuccess:!1,containerFail:!1}),i=R({iconCls:"arrow-right",width:"0",left:"0"}),f=g(),k=g(),E=g(),S=g();let T;const{success:D,start:b,move:Q,end:Z,verify:ee}=Te(),U=()=>{var m,y;D.value=!1,l.containerActive=!1,l.containerSuccess=!1,l.containerFail=!1,i.iconCls="arrow-right",i.left="0",i.width="0",f.value.style.left="0",(m=S.value)==null||m.clearRect(0,0,c,r),(y=k.value)==null||y.clearRect(0,0,c,r),f.value.width=c,T.src=q(s)},te=()=>{U(),t("refresh")};function se(m){i.left=m+"px";let y=(c-40-20)/(c-40)*m;f.value.style.left=y+"px",l.containerActive=!0,i.width=m+"px"}function oe(m){const{spliced:y,TuringTest:C}=ee(f.value.style.left,d.value,v);if(y){if(v===-1){l.containerSuccess=!0,i.iconCls="success",D.value=!0,t("success",m);return}C?(l.containerSuccess=!0,i.iconCls="success",D.value=!0,t("success",m)):(l.containerFail=!0,i.iconCls="fail",t("again"))}else l.containerFail=!0,i.iconCls="fail",t("fail"),setTimeout(()=>{U()},1e3)}const $=Se(m=>{Q(c,m,se)},w),A=m=>{Z(m,oe)};return ae(()=>{var m,y;const C=(m=E.value)==null?void 0:m.getContext("2d"),I=(y=f.value)==null?void 0:y.getContext("2d");S.value=C,k.value=I,T=Ee(s,()=>{u.value=!1;const M=n+o*2+3;if(d.value=j(M+10,c-(M+10)),a.value=j(10+o*2,r-(M+10)),C&&I){x(C,d.value,a.value,n,o,"fill"),x(I,d.value,a.value,n,o,"clip"),C.drawImage(T,0,0,c,r),I.drawImage(T,0,0,c,r);const Y=a.value-o*2-1,ne=I.getImageData(d.value,Y,M,M);f.value.width=M,I.putImageData(ne,0,Y)}}),document.addEventListener("mousemove",$),document.addEventListener("mouseup",A)}),re(()=>{document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",A)}),{block:f,canvas:E,loadBlock:u,containerCls:l,sliderBox:i,refresh:te,sliderDown:b,touchStartEvent:b,touchMoveEvent:$,touchEndEvent:A}}}),Me=e=>(G("data-v-f61c42f2"),e=e(),H(),e),Ve=["width","height"],De=Me(()=>p("i",{class:"iconfont icon-refresh"},null,-1)),Ne=[De],Be=["width","height"],Re={class:"slide-verify-slider-text"};function $e(e,t,s,n,o,c){return B(),X("div",{id:"slideVerify",class:"slide-verify",style:z({width:e.w+"px"}),onselectstart:"return false;"},[p("div",{class:L({"slider-verify-loading":e.loadBlock})},null,2),p("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,Ve),e.show?(B(),X("div",{key:0,class:"slide-verify-refresh-icon",onClick:t[0]||(t[0]=(...r)=>e.refresh&&e.refresh(...r))},Ne)):J("",!0),p("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,Be),p("div",{class:L(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[p("div",{class:"slide-verify-slider-mask",style:z({width:e.sliderBox.width})},[p("div",{class:"slide-verify-slider-mask-item",style:z({left:e.sliderBox.left}),onMousedown:t[1]||(t[1]=(...r)=>e.sliderDown&&e.sliderDown(...r)),onTouchstart:t[2]||(t[2]=(...r)=>e.touchStartEvent&&e.touchStartEvent(...r)),onTouchmove:t[3]||(t[3]=(...r)=>e.touchMoveEvent&&e.touchMoveEvent(...r)),onTouchend:t[4]||(t[4]=(...r)=>e.touchEndEvent&&e.touchEndEvent(...r))},[p("i",{class:L(["slide-verify-slider-mask-item-icon","iconfont",`icon-${e.sliderBox.iconCls}`])},null,2)],36)],4),p("span",Re,W(e.sliderText),1)],2)],4)}var Ae=Ce(Ie,[["render",$e],["__scopeId","data-v-f61c42f2"]]);const Le="/assets/img1-182c2f76.jpg",ze="/assets/img2-3217378f.jpg",Fe="/assets/img3-5b97d210.jpg",Xe="/assets/img4-96696b7b.jpg";const O=e=>(G("data-v-6eb088b2"),e=e(),H(),e),je={class:"background-image"},qe=O(()=>p("div",{style:{"font-weight":"bold","font-size":"35px","text-align":"center",color:"darkgreen","padding-top":"50px"}},"健康食谱管理与膳食规划系统",-1)),Oe={class:"login-box"},Ue=O(()=>p("div",{style:{"font-weight":"bold","font-size":"28px","text-align":"center","margin-bottom":"30px",color:"#057748"}},"登 录",-1)),Ye=O(()=>p("div",{style:{"text-align":"right"}},[K(" 还没有账号？请 "),p("a",{href:"/register",style:{color:"#057748"}},"注册")],-1)),Pe={__name:"Login",setup(e){const t=g(""),s=g(null),n=g(!1),o=R({form:{username:"",password:"",role:"USER"},loginData:{},slideImgs:[Le,ze,Fe,Xe],rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:10,message:"长度在3-10个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:10,message:"长度在3-10个字符",trigger:"blur"}]}}),c=g(null),r=()=>{var a;t.value="检测到非人为操作，请再试一次！",(a=s.value)==null||a.refresh()},v=()=>{n.value=!1,d()},w=()=>{var a;t.value="验证失败，请重新滑动",(a=s.value)==null||a.refresh()},u=()=>{c.value.validate(a=>{a?n.value=!0:N.error("请填写正确的账号和密码")})},d=()=>{we.post("/login",o.form).then(a=>{a.code==="200"?(o.loginData=a.data,N.success("登录成功"),pe.push("/"),localStorage.setItem("system-user",JSON.stringify(a.data))):(N.error(a.msg),n.value=!1)}).catch(()=>{N.error("网络错误，请稍后再试"),n.value=!1})};return(a,l)=>{const i=ge,f=he,k=ye,E=be,S=_e,T=de,D=fe;return B(),X("div",je,[qe,p("div",Oe,[Ue,h(T,{model:o.form,ref_key:"formRef",ref:c,rules:o.rules,onSubmit:ue(u,["prevent"])},{default:_(()=>[h(f,{prop:"username"},{default:_(()=>[h(i,{"prefix-icon":F(me),size:"large",modelValue:o.form.username,"onUpdate:modelValue":l[0]||(l[0]=b=>o.form.username=b),placeholder:"请输入账号"},null,8,["prefix-icon","modelValue"])]),_:1}),h(f,{prop:"password"},{default:_(()=>[h(i,{"prefix-icon":F(ve),size:"large",modelValue:o.form.password,"onUpdate:modelValue":l[1]||(l[1]=b=>o.form.password=b),placeholder:"请输入密码","show-password":""},null,8,["prefix-icon","modelValue"])]),_:1}),h(f,{prop:"role"},{default:_(()=>[h(E,{size:"large",style:{width:"100%"},modelValue:o.form.role,"onUpdate:modelValue":l[2]||(l[2]=b=>o.form.role=b)},{default:_(()=>[h(k,{value:"USER",label:"普通用户",style:{color:"#1fab89"}}),h(k,{value:"ADMIN",label:"管理员",style:{color:"#1fab89"}})]),_:1},8,["modelValue"])]),_:1}),h(f,null,{default:_(()=>[h(S,{size:"large",type:"success",style:{width:"100%"},disabled:n.value,onClick:u},{default:_(()=>[K(" 登 录 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules","onSubmit"]),Ye]),n.value?(B(),ce(D,{key:0,class:"cover"},{default:_(()=>[h(F(Ae),{class:"silde_box",ref_key:"block",ref:s,l:42,r:10,w:310,h:155,accuracy:5,imgs:o.slideImgs,"slider-text":"向右滑动",onAgain:r,onSuccess:v,onFail:w,onRefresh:a.onRefresh},null,8,["imgs","onRefresh"]),p("div",null,W(t.value),1)]),_:1})):J("",!0)])}}},Qe=ie(Pe,[["__scopeId","data-v-6eb088b2"]]);export{Qe as default};

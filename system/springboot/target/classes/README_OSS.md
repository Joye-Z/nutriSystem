# OSS 文件服务使用说明

## 文件路径说明

- **上传时**：文件会自动按照 `yyyy-MM-dd/文件名` 的格式上传到OSS中，文件名会自动生成唯一标识
- **上传接口返回**：接口直接返回完整的文件URL，格式为：`https://healthsystem-bucket.oss-cn-shenzhen.aliyuncs.com/yyyy-MM-dd/文件名`
- **下载时**：
  1. 支持直接使用完整OSS路径（yyyy-MM-dd/文件名）
  2. 若只提供文件名（不含日期目录），系统会：
     - 记录警告信息
     - 智能搜索最近30天的所有日期目录查找文件
     - 这能解决历史数据中可能只存储了文件名的情况
- **图片显示**：前端可以直接使用上传接口返回的URL作为图片的src属性

## 注意事项

1. 确保环境变量正确配置，包括OSS的endpoint、accessKeyId、accessKeySecret和bucketName
2. 前端上传文件时，应当使用upload接口返回的完整路径存储在数据库中，以确保后续能正确下载文件
3. 系统已经优化了对历史数据的兼容性，对于只存储了文件名的旧数据，会尝试在最近30天内查找对应的文件